#!/usr/bin/env python

import socket
import struct


rawSocket = socket.socket(socket.PF_PACKET, socket.SOCK_RAW, socket.htons(0x0800))
while True:
	pkt = rawSocket.recvfrom(2048)
	tcpHeader = pkt[0][34:54]
	tcp_hdr = struct.unpack("!HH16s", tcpHeader)
	print "Source Port : " + str(tcp_hdr[0])
	print "Destination Port :"+ str(tcp_hdr[1])
